<VirtualHost *:80>
        ServerName aaronbae.com

        RewriteEngine on
        RewriteCond %{HTTP:X-Forwarded-Proto} =http
        RewriteRule .* https://%{HTTP:Host}%{REQUEST_URI} [L,R=permanent]


        ErrorLog   ${APACHE_LOG_DIR}/error.log
        CustomLog  ${APACHE_LOG_DIR}/access.log combined
        LogLevel warn

        ## Here's our magic
        ProxyPreserveHost On
        ProxyVia Full
        ProxyRequests off

        <Proxy *>
                Order deny,allow
                Allow from all
        </Proxy>
        ProxyPass /api/ http://localhost:4000/api/
        ProxyPassReverse /api/ http://localhost:4000/api/

        ProxyPass / http://localhost:3000/
        ProxyPassReverse / http://localhost:3000/
</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet