#!/bin/sh
echo "[post-receive] : Post-receive hook initiated"i
cd /home/ubuntu/aaronbae.com/
echo "[post-receive] : Changed directory to /home/ubuntu/aaronbae.com/"
sudo git --git-dir=/home/ubuntu/aaronbae.com.git --work-tree=/home/ubuntu/aaronbae.com checkout master -f
echo "[post-receive] : Installing Backend packages"
cd backend
sudo npm install -s
echo "[post-receive] : Restarting Backend"
sudo pm2 restart backend
echo "[post-receive] : Installing Frontend packages"
cd ../frontend
sudo npm install -s
echo "[post-receive] : Building Frontend"
sudo npm run build
echo "[post-receive] : Strating Frontend"
sudo pm2 restart frontend
echo "[post-receive] : Restarting Apache2"
sudo service apache2 restart
echo "[post-receive] : Apache2 server status"
sudo systemctl status apache2
echo "[post-receive] : Post-receive hook process finished."
sudo mkdir ~/aaronbae.com/backend/temp
echo "[post-receive] : Created temp folder for backend."
echo "NODE_ENV=development
MONGO_ATLAS_URL="mongodb://aaronbae:kingoftheworld123@cluster0-shard-00-01-ecnt3.mongodb.net:27017,cluster0-shard-00-01-ecnt3.mongodb.net:27017,cluster0-shard-00-02-ecnt3.mongodb.net:27017?replicaSet=Cluster0-shard-0"
MONGO_EC2_URL="mongodb://aaronbae:kingoftheworld123@ec2-34-221-91-61.us-west-2.compute.amazonaws.com:27017/aaronbaeDB"
AWS_SECRET_ACCESS_KEY=RZ57sufBdI9okG5DPgGvLyI7l+FDGVNNOPDmPXyF
FINN_HUB_TOKEN=bt5bjov48v6vdhrudv40
SENTRY_DSN="https://c7f35c6182a34d129374dc31f77ae3b5@o418535.ingest.sentry.io/5322885"
ADMIN_SERVICE_CLIENT="108182418653117147059"
ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCro8k2qF2R5BKi\nl2y4Jdi5uPIGin/Kqox+LE/ZUB3+Q3q09xkEFphXcItE0mP1huCAKA3zsxiXxsde\nF/ICBIz1eyMeQCrSzR56OfXYn04o5VrkQmEDx99xmh+2ZEXsKB42YAyCv//FVGkw\nKbDLeEsstXdfFGLqCLA7sjp37YK3e1+XZwFJujsA83Gp1zNqv7/WaWz+ml7H12NY\nXw9EsEIjSLbgV+k6c2Xg/dyfbBEft29zktjS+WzgDi6glN3SDuD4nal1lUWDt7MU\nK8+C/Srm/GL00siJQasKPBZg/735wfZF/yr4SKbhbA2jkDE0kI3GV+FGloOsPnSo\nfrGkmJUtAgMBAAECggEAKXhcxOaAGSBEemFgxMtsJk9vtrHe934mjNOzBTwMyyLN\nsoyjUDAPZc0M8TduLGQGuSA0YsXKct11zR+2+tLTpfo2/XeegSlLLFf1tP2kmk/0\nGoOJQisYKzAEaoKmvEzjI9soGq0+JJTlB1yDWV36t9YufdwEnCw2PG4vH0vVEfSI\nsyLfVQTuSGieNEGWARbJJ9sERJncUn0QIUpfF5AQTS2OnQMNvDKID2zjGcGwCPs3\nEBi5FA+yK604sX9NxRhyXUgeqiGSyHYWaLZfqmwcPCpH0ypUH98dh5nIvB2OLVSd\nd4CEItSHGnf98mp8OWBLl0hdf+cAOam2t5jar6BCMQKBgQDqVa6X8BQMk5fUaWLJ\n3iPZ4hTCKXOZhywOls4nvtcGftwznO9n6HSSLezw0KQyntNVlHM4rzyPEoikoASC\nx2mImcl0EQT1mQ3K5fz93Rj3EfVzF5nkAUZOnHGqYeKpzwGhPvtctN61sPskNxPx\nK/p6kZsBzOqGMxKma72IVi4gtQKBgQC7gjfmEvQkl45SKkTDZVN0//GwhYaYTVR+\ntmLpF5XmDqDySmfrTO5Gj20haGnLoCFRS78cyMrriff2+VAcXvZqmnZHH8z3BUTb\nFIE3mhOoqQDj/X1S6vQrERtj13/KiQJ1mjvjOgSdd5+zfcsgtjbA6d44rHP+LIgG\ngqsnNoWFmQKBgHpKFqAx6LSbfXubN7OzWrBE/KJK8YnoccR3TMSPIjXAlHfW6VUn\niVYT43fU2iuUmSMrImotgQQFHwwSeegp2tgvsWMB0r28jucY2Ms+y918IMRcR7Im\nPCOgHu1Uwe3uGqKkdJbvyN22q4k9uQl98uxt+h+ZabZ5Br2Uskdo+g+VAoGAUJmy\nA5EEJzKKd+E5e7Bzhmh6cMGE0LT07B7kN4Pu6FxDbML1Fp0UE3qVk3W5fFER4Usp\nFGtvZn4A+8XBXOCpFbvducb+qPQ32+BdhxQQ/T/gZSBSnbDnUhfhaTJ5+QqZ5wls\nUslesH16RYJ+LUqGELi20C+5EHn94qaKgambDYkCgYAGfGZTCZ1SeFzCiGG3oH4C\nz5KjD2bUOz0eJp34UxLpWTIw+6UsX4yKQBzJw7YB6v2K3q8bKQS+2s7KbppezuOk\n/3jI835fceDahJK1DoheWOcCfOpbTdRskguj1vIB/9OjaoRPQCctIeMo3ew6HouD\n4zt20Ka4CcuPOrxByNKDgA==\n-----END PRIVATE KEY-----\n"
ADMIN_EMAIL="aaron@aaronbae.com"" >> ~/aaronbae.com/backend/.env
echo "[post-receive] : Resetted the .env for backend."
# Below script is just for future references
#sudo pm2 start "npm run start" --name frontend
